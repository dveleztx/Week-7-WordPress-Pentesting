# Week 7 - WordPress Pentesting
## Objective
*Discover and Demonstrate proof-of-concepts for at least three and up to five exploits affecting an old version of WordPress*

### Time Spent
*13 hrs*

# Report
<h3>1. WordPress <= 4.2 - Unauthenticated Stored Corss-Site Scripting (XSS)</h3>

Details:
- Type of attack: XSS
- WordPress versions affected: 4.2 and lower

References (from WPScan):
- [Exploit Database](https://www.exploit-db.com/exploits/36844/)
- [Klikki's Advisory](https://klikki.fi/adv/wordpress2.html)

Demonstration:
<img src="https://i.imgur.com/5alVORv.gif" width="800">

Steps to duplicate issue:
- On a post, there must be a pre-existing comment
- Inject attack as a comment using the following, note the inject must be greater than 64KB: 
  - ```<a title='x onmouseover=alert(unescape(/hello%20world/.source)) style=position:absolute;left:0;top:0;width:5000px;height:5000px  AAAAAAAAAAAA...[64 kb]..AAA'></a>```
- At this point, the inject works and conducts the XSS attack on the attackers side
- If administrator approves the comment, the attack can be perpetually executed when victims view the comment


<h3>2. WordPress 4.1-4.2.1 - Unautenticated Genericons Cross-Site Scripting (XSS)</h3>

Details:
- Type of attack: XSS
- WordPress versions affected 4.1-4.2.1

References (from WPScan):
- [WPVulnDB](https://wpvulndb.com/vulnerabilities/7979)

Demostration: 
<img src="https://i.imgur.com/1wJoknY.gif" width="800">

Steps to duplicate issue:
- Administrator would need to have the plugin from Max Mega for "Genericons"
- User uploads genericon to the list of icons with the XSS name
- Administrator goes to the example html page of the Genericons to trigger attack

<h3>3. WordPress 4.9.6 Arbitrary File Deletion Vulnerability Exploit (IDOR, Injection, Privilege Escalation)</h3>

Details:
- Type of attack: IDOR, Injection, Privilege Escalation
- WordPress versions affected 4.9.6 or less

References:
- [VolnSpy](https://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility-Exploit/)

Demonstration:
<img src="https://i.imgur.com/RlYUHAA.gif" width="800">

Steps to duplicate issue:
- Upload an image file and go to edit the file 
- Inspect picture element and grab cookies and WordPress nonce
- Run a curl script to check if authentication through an injection returns data, once confirmed, continue
- Inspect the delete permanently link and get nonce from that
- Run secondary curl script with the new nonce to conduct an action for deleting the post (image)
- This does a privilege escalation and deletes more than just the image, but causes WordPress to be wiped


<h3>4. WordPress 3.x - 4.2 Path Traversal, Directory Listing and Directory Deletion</h3>

Details:
- Type of attack: IDOR, CSRF
- WordPress versions affected: 3.x and up to 4.2 (maybe even beyond, but not current version, tested this)

References:
- [HomeLab.it](https://www.homelab.it/index.php/2014/08/06/wordpress-3-4-vulnerabilities/)

Demonstration:
<img src="https://i.imgur.com/Cgh4E3L.gif" width="800">

Steps to duplicate issue:
- Go to delete plugin
- Delete the plugin portion of the url and inject traversal
- Delete files using the built in button after it displays the list of items in the directory explored

<h3>5. WordPress Comment XSS</h3>

Details:
- Type of attack: XSS
- Wordpress versions affected 4.7.1 and lower

References:
- [YouTube](https://www.youtube.com/watch?v=UD-iwqphWlk)

Demonstration: 
<img src="https://i.imgur.com/ScPMuoY.gif" width="800">

Steps to duplicate issue:
- Go to a page
- Post XSS in comments section
